# PWA 离线使用指南

## 📱 什么是PWA？

PWA（Progressive Web App）是一种可以像原生应用一样安装到手机桌面的网页应用，具有以下特性：

- ✅ **可安装**：可以添加到手机桌面，像原生应用一样使用
- ✅ **离线工作**：即使没有网络也能正常使用
- ✅ **快速加载**：资源被缓存，加载速度更快
- ✅ **原生体验**：提供类似原生应用的用户体验

## 🚀 如何安装PWA应用

### Android 设备

1. **使用Chrome浏览器**：
   - 打开应用页面
   - 点击地址栏右侧的"安装"按钮
   - 或点击菜单中的"添加到主屏幕"

2. **使用其他浏览器**：
   - 三星浏览器：菜单 → 添加到主屏幕
   - Firefox：菜单 → 添加到主屏幕
   - Edge：菜单 → 安装此网站作为应用

### iOS 设备

1. **使用Safari浏览器**：
   - 打开应用页面
   - 点击分享按钮（方框+箭头）
   - 选择"添加到主屏幕"
   - 点击"添加"

## 🔄 离线使用步骤

### 第一步：首次访问（需要网络）

1. 在有网络的环境下访问应用
2. 等待页面完全加载
3. 此时Service Worker会自动缓存所有必要文件

### 第二步：安装到桌面

1. 按照上述方法将应用安装到桌面
2. 安装后可以从桌面图标直接启动应用

### 第三步：离线使用

1. 断开网络连接
2. 从桌面图标启动应用
3. 应用将完全离线运行，所有IndexedDB功能正常

## 📋 离线功能说明

### ✅ 完全支持的功能

- **数据管理**：添加、编辑、删除记录
- **数据搜索**：实时搜索功能
- **数据统计**：查看记录数和数据库大小
- **数据导出**：导出JSON文件（需要网络时同步）
- **操作日志**：查看所有操作历史

### ⚠️ 部分限制的功能

- **数据导入**：需要网络连接才能选择文件
- **应用更新**：需要网络连接才能获取最新版本

## 🔧 技术实现细节

### Service Worker 缓存策略

```javascript
// 缓存的文件列表
const urlsToCache = [
  '/',
  '/index.html',
  '/styles.css',
  '/script.js',
  '/manifest.json',
  '/sw.js'
];
```

### 离线检测机制

```javascript
// 网络状态监听
window.addEventListener('online', () => {
  // 网络恢复时的处理
});

window.addEventListener('offline', () => {
  // 网络断开时的处理
});
```

## 🛠️ 故障排除

### 问题1：应用无法安装

**解决方案**：
- 确保使用HTTPS协议或localhost
- 检查浏览器是否支持PWA
- 清除浏览器缓存后重试

### 问题2：离线功能不工作

**解决方案**：
- 确保首次在有网络环境下访问过应用
- 检查Service Worker是否正常注册
- 在浏览器开发者工具中查看Service Worker状态

### 问题3：数据丢失

**解决方案**：
- IndexedDB数据存储在本地，不会因离线而丢失
- 如果数据丢失，可能是浏览器数据被清除
- 建议定期导出数据作为备份

## 📱 最佳实践

### 1. 首次使用建议

- 在有稳定网络的环境下首次访问
- 添加一些测试数据验证功能
- 将应用安装到桌面以便快速访问

### 2. 数据管理

- 定期导出重要数据作为备份
- 利用搜索功能快速查找记录
- 使用备注字段记录额外信息

### 3. 离线使用

- 在需要离线使用前，确保应用已完全加载
- 离线时仍可正常添加和管理数据
- 网络恢复后数据会自动同步

## 🔄 更新机制

### 自动更新

- 当有新版本时，Service Worker会自动更新
- 更新过程对用户透明，无需手动操作
- 更新后应用功能会得到增强

### 手动更新

- 在浏览器设置中清除网站数据
- 重新访问应用页面
- 等待Service Worker重新注册和缓存

## 📞 技术支持

如果在使用过程中遇到问题：

1. 检查浏览器控制台是否有错误信息
2. 确认浏览器版本是否支持PWA
3. 尝试清除浏览器缓存后重试
4. 查看操作日志了解详细错误信息

---

**注意**：PWA功能需要现代浏览器支持，建议使用Chrome、Firefox、Safari、Edge等最新版本浏览器。
